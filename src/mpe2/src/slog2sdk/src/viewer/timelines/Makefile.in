
## End User configurable options ###
SHELL = /bin/sh

@VPATH@
# Installation directories
prefix       = @prefix@
exec_prefix  = @exec_prefix@
bindir       = @bindir@
includedir   = @includedir@
libdir       = @libdir@
# Build directories
libbuild_dir = @libbuild_dir@
top_srcdir   = @top_srcdir@
srcdir       = @srcdir@

JC           = @JC@
JAR          = @JAR@
RM           = @RM@

TARGET    = $(libbuild_dir)/timeline_view.jar
PACKAGE   = viewer.timelines
SRC       = Diagnosis.java Debug.java Profile.java \
            YaxisTreeNode.java IntegerArrayComparator.java YaxisMaps.java \
            named_vector.java YaxisTree.java \
            TimeEvent.java TimeListener.java \
            ModelTime.java ScrollbarTime.java \
            ModelTimePanel.java TreeTrunkPanel.java \
            InfoDialog.java InfoDialogForTime.java \
            InfoDialogForDuration.java InfoDialogForDrawable.java \
            ScrollableView.java ScrollableObject.java \
            ToolBarStatus.java ViewportTime.java ViewportTimeYaxis.java \
            RulerTime.java ViewportTimePanel.java \
            CoordPixelImage.java CanvasTime.java \
            ActionVportUp.java ActionVportDown.java \
            ActionTimelineMark.java ActionTimelineMove.java \
            ActionTimelineDelete.java \
            ActionYaxisTreeExpand.java ActionYaxisTreeCollapse.java \
            ActionYaxisTreeCommit.java \
            ActionVportBackward.java ActionVportForward.java \
            ActionVportUp.java ActionZoomHome.java ActionVportDown.java \
            ActionZoomIn.java ActionZoomOut.java \
            ActionZoomUndo.java ActionZoomRedo.java ActionSearch.java \
            ActionPptyRefresh.java ActionPptyPrint.java ActionPptyStop.java \
            TimelineToolBar.java TimelinePanel.java TimelineFrame.java

OBJ       = $(SRC:.java=.class)

TS_TARGET = $(libbuild_dir)/ts_time.jar
TS_SRC    = TestMainToolBar.java TestMainPanel.java TestMainFrame.java
TS_OBJ    = $(TS_SRC:.java=.class)

.SUFFIXES:	.java .class .jar

# CLASSPATH = .:/pkgs/lang/java/jdk117_v3/lib/rt.jar:/pkgs/lang/java/jdk117_v3/lib/classes.zip:/pkgs/lang/java/jdk117_v3/classes:/home/chan/mpe_work/mpe/viewers/jumpshot-3/swing/swing.jar
SRCDIR     = $(top_srcdir)
CLASSDIR   = ../..
CLASSPATH  = ../..
PKGDIR     = viewer/timelines

JFLAGS = -sourcepath @JPATH_START@$(SRCDIR)@JPATH_FINAL@ -classpath @JPATH_START@$(CLASSPATH)@JPATH_FINAL@ -d @JPATH_START@$(CLASSDIR)@JPATH_FINAL@ @JFLAGS@

.java.class:
	$(JC) $(JFLAGS) @JPATH_START@$<@JPATH_FINAL@

# echo "Class-Path: images" >> $(PACKAGE).manifest ;

ALL: $(OBJ)

$(TARGET): $(OBJ)
	cd $(CLASSDIR) ; \
	$(RM) $(PACKAGE).manifest ; \
	echo "Main-Class: $(PACKAGE).TimelineFrame" > $(PACKAGE).manifest ; \
	jarfile=@JPATH_START@$@@JPATH_FINAL@ ; \
	$(JAR) cvfm $${jarfile} $(PACKAGE).manifest ; \
	for dir in base/io/ base/topology/ base/drawable/ \
	           logformat/slog2/ logformat/slog2/input/ \
	           viewer/common/ viewer/legends/ $(PKGDIR)/ ; do \
	    classdir_prefix=@JPATH_START@$${dir}@JPATH_FINAL@ ; \
	    $(JAR) uvf $${jarfile} $${classdir_prefix}*.class ; \
	done ; \
	$(JAR) uvf $${jarfile} images/*.gif applet.html

# Only need base/drawable/TimeBoundingBox.class from base/drawable
$(TS_TARGET): $(OBJ) $(TS_OBJ)
	cd $(CLASSDIR) ; \
	$(RM) $(PACKAGE).manifest ; \
	echo "Main-Class: $(PACKAGE).TestMainFrame" > $(PACKAGE).manifest ; \
	jarfile=@JPATH_START@$@@JPATH_FINAL@ ; \
	$(JAR) cvfm $${jarfile} $(PACKAGE).manifest ; \
	for dir in base/drawable/ viewer/common/ $(PKGDIR)/ ; do \
	    classdir_prefix=@JPATH_START@$${dir}@JPATH_FINAL@ ; \
	    $(JAR) uvf $${jarfile} $${classdir_prefix}*.class ; \
	done ; \
	$(JAR) uvf $${jarfile} images/*.gif applet.html

clean:
	cd $(CLASSDIR) ; \
	$(RM) $(PACKAGE).manifest $(PKGDIR)/*.class

rmlib:
	$(RM) $(TARGET) $(TS_TARGET)

realclean: clean rmlib
