#! /bin/sh
#
# Create the indexes for both the main page and all of the sections
#
WWWRoot=`pwd`
URLBase="http://www-unix.mcs.anl.gov/mpi"
for arg in "$@" ; do
    case $arg in 
    -wwwroot=*)
    WWWRoot=`echo A$arg | sed -e s/A-wwwroot=//g` ;;
    -help)
	echo "$0 [-wwwroot=directory] "
	echo "Build the WWW pages for MPICH."
	echo "You must start this in the root for a MPICH tree."
	exit 0
	;;

    -echo)
    set -x ;;

    *) 
    echo "Unknown argument $arg"
    exit 1
    ;;
    esac
done
/bin/rm -f $WWWRoot/www/index.html $WWWRoot/www/www1/index.html 
/bin/rm -f $WWWRoot/www/www3/index.html $WWWRoot/www/www4/index.html
#
# Main index
cat <<EOF >>$WWWRoot/www/index.html
<TITLE>Web pages for MPI and MPE</TITLE>
<!-- This file generated by MPI/maint/makewwwindex-->
<BODY BGCOLOR="FFFFFF">
<H1>Web pages for MPI and MPE</H1>
<H2>MPI Commands</H2>
EOF
(cd $WWWRoot ; \
ls -1 www/www1 | \
          sed -e 's%^\(.*\).html$%<LI><A HREF="www1/\1.html">\1</A>%g' \
		| /home/MPI/maint/makehtmltable -cols 3 \
		>> $WWWRoot/www/index.html )
cat <<EOF >>$WWWRoot/www/index.html
<H2>MPI Routines</H2>
EOF
(cd $WWWRoot ; \
ls -1 www/www3 | \
          sed -e 's%^\(.*\).html$%<LI><A HREF="www3/\1.html">\1</A>%g' \
		| /home/MPI/maint/makehtmltable -cols 3 \
		>> $WWWRoot/www/index.html )
cat <<EOF >>$WWWRoot/www/index.html
<H2>MPE Routines</H2>
EOF
(cd $WWWRoot ; \
ls -1 www/www4 | \
	  sed -e 's%^\(.*\).html$%<LI><A HREF="www4/\1.html">\1</A>%g' \
		| /home/MPI/maint/makehtmltable -cols 3 \
		>> $WWWRoot/www/index.html )
cat <<EOF >>$WWWRoot/www/index.html
</BODY>
EOF
#
# Sectional indices
# Command
cat <<EOF >>$WWWRoot/www/www1/index.html
<TITLE>Web pages for MPICH Commands</TITLE>
<!-- This file generated by MPI/maint/makewwwindex-->
<BODY BGCOLOR="FFFFFF">
<H1>MPICH Commands</H1>
<MENU>
EOF
(cd $WWWRoot ; \
ls -1 www/www1 | grep -v index | \
          sed -e 's%^\(.*\).html$%<LI><A HREF="\1.html">\1</A>%g' \
		>> $WWWRoot/www/www1/index.html )
cat <<EOF >>$WWWRoot/www/www1/index.html
</MENU>
</BODY>
EOF
#
# Routines
cat <<EOF >>$WWWRoot/www/www3/index.html
<TITLE>Web pages for MPI Routines</TITLE>
<!-- This file generated by MPI/maint/makewwwindex-->
<BODY BGCOLOR="FFFFFF">
<H1>MPI Routines</H1>
EOF
(cd $WWWRoot ; \
ls -1 www/www3 | grep -v index | \
          sed -e 's%^\(.*\).html$%<LI><A HREF="\1.html">\1</A>%g' \
		| /home/MPI/maint/makehtmltable -cols 3 \
    >> $WWWRoot/www/www3/index.html )
cat <<EOF >>$WWWRoot/www/www3/index.html
</BODY>
EOF
#
# MPE Routines
cat <<EOF >>$WWWRoot/www/www4/index.html
<TITLE>Web pages MPE Routines</TITLE>
<!-- This file generated by MPI/maint/makewwwindex-->
<BODY BGCOLOR="FFFFFF">
<H1>MPE Routines</H1>
<MENU>
EOF
(cd $WWWRoot ; \
ls -1 www/www4 | grep -v index | \
	  sed -e 's%^\(.*\).html$%<LI><A HREF="\1.html">\1</A>%g' \
		| /home/MPI/maint/makehtmltable -cols 3 \
	>>	$WWWRoot/www/www4/index.html )
cat <<EOF >>$WWWRoot/www/www4/index.html
</MENU>
</BODY>
EOF
#
	#@echo '<H2>ADI Interface</H2>'  >> www/index.html
	#@echo '<MENU>' >> www/index.html
	#ls -1 www/www5 | \
	# sed -e 's%^\(.*\).html$$%<LI><A HREF="www5/\1.html">\1</A>%g' >> \
	#	www/index.html
	#@echo '</MENU>' >> www/index.html

exit 0
