%
% This file contains a discussion of a possible TCP device
% implementation of ADI3  

\documentclass{article}
\usepackage{psfig}

\def\nopound{\catcode`\#=13}
{\nopound\gdef#{{\tt \char`\#}}}
\catcode`\_=13
\def_{{\tt \char`\_}}
\catcode`\_=11
\def\code#1{\texttt{#1}}

\begin{document}

\title{A TCP Implementation of the ADI-3}
\author{}
\maketitle

\begin{abstract}

\end{abstract}

\section{Introduction}
This document outlines an implementation of the ADI on TCP.  It defines a
specific interface to the low level OS TCP operations, and outlines a way
for at least the basic MPID_ routines to be implemented in terms of these
abstract operations.  This document is preliminary.

\section{Outline of the Implementation Structure}

\begin{verbatim}
Notes from the board


\end{verbatim}

\section{Pseudo-code for some of the \code{MPID_} routines}

\begin{verbatim}

MPID_Isend( )
{

}
\end{verbatim}

\begin{verbatim}
MPID_Irecv( )
{

}
\end{verbatim}

\begin{verbatim}
MPID_Wait( )
{

}
\end{verbatim}

%\subsection{}
\begin{verbatim}

\end{verbatim}

\section{Pseudo-code for Message Handlers}
These are the routines that are called by the progress engine on receiving a
message packet.  All of these assume that the entire packet header has been 
read but that any following data may not yet have been read.

\subsection{EagerSend}
\begin{verbatim}
    FOA( tag, source, contextid, &request )
    if (found) {
        TransferDataToDest from socket
    }
    else {
        AllocateStorageFromEagerBuffer
        TransferDataToDest (contiguous) from socket
    }
\end{verbatim}

\subsection{RndvReqToSend}
\begin{verbatim}
    FOA( tag, source, contextid, &request )
    if (found) {
        if (dest buffer is contiguous)
            Send RndvOkToPut to source
        else
            Send RndvOkToSend to source
    }
\end{verbatim}

\subsection{RndvOkToSend}
\begin{verbatim}
    Find matching request (from id)
    Send RndvData to dest
\end{verbatim}

\subsection{Put}
\begin{verbatim}
    Read Address from packet
    TransferDataToDest (contiguous)
\end{verbatim}

\subsection{RndvData}
\begin{verbatim}
    Find matching request (from id)
    Find memory location
    TransferDatatoDest
    When done, if more data needed, send RndvOkToSend to source
\end{verbatim}

\subsection{CancelSend}
\begin{verbatim}
    Find matching request (from id)
    If (found and alread matched) {
        Send CancelSendAck(failed)
    }
    else {
        Remove and discard request
        Send CancelSendAck(succeeded)
    }
 \end{verbatim}

\subsection{CancelSendAck}
\begin{verbatim}
   Set request to indicate whether cancel succeeded
\end{verbatim}

\subsection{FlowControlUpdate}
\begin{verbatim}
   (Not yet defined)
\end{verbatim}

\section{Summary}
\label{sec:tcpadi-summary}
(This section should summarize the TCP\_ routines, giving just their prototypes)

\end{document}
